<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Tabela de Empréstimo</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;700&family=Exo+2:wght@400;600&display=swap');

        body {
            background: linear-gradient(135deg, #000000, #1a1a1a);
            color: #ffffff;
            font-family: 'Exo 2', sans-serif;
            display: flex;
            justify-content: center;
            align-items: flex-start;
            min-height: 100vh;
            margin: 0;
            padding: 10px;
            box-sizing: border-box;
            font-size: 16px;
        }

        .container {
            background: rgba(0, 0, 0, 0.9);
            border: 1px solid #FFD700;
            border-radius: 10px;
            padding: 15px;
            box-shadow: 0 0 10px #FFD700;
            width: 100%;
            max-width: 600px;
            margin: 10px auto;
            box-sizing: border-box;
        }

        .header-image {
            width: 80%;
            max-width: 300px;
            height: auto;
            margin: 0 auto 15px;
            display: block;
            object-fit: contain;
        }

        h1, h2 {
            text-align: center;
            color: #FFD700;
            margin: 0 0 15px;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            font-size: 1.5rem;
        }

        h2 {
            font-size: 1.2rem;
        }

        label {
            display: block;
            margin: 8px 0 5px;
            font-weight: 600;
            color: #FFD700;
            font-size: 1rem;
        }

        input, select {
            width: 100%;
            padding: 12px;
            box-sizing: border-box;
            margin-bottom: 12px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid #FFD700;
            border-radius: 5px;
            color: #ffffff;
            font-family: 'Exo 2', sans-serif;
            font-size: 1rem;
            transition: border-color 0.3s;
        }

        input:focus, select:focus {
            border-color: #ffffff;
            outline: none;
        }

        button {
            width: 100%;
            padding: 12px;
            background: linear-gradient(45deg, #FFD700, #ffffff);
            border: none;
            border-radius: 5px;
            color: #000000;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
            font-size: 1.1rem;
            cursor: pointer;
            transition: transform 0.1s;
            touch-action: manipulation;
        }

        button:hover, button:active {
            transform: scale(1.02);
        }

        .table-wrapper {
            overflow-x: auto;
            -webkit-overflow-scrolling: touch;
        }

        table {
            width: 100%;
            min-width: 600px;
            border-collapse: collapse;
            background: rgba(255, 255, 255, 0.05);
            margin-bottom: 15px;
        }

        th, td {
            padding: 8px;
            text-align: center;
            border: 1px solid #FFD700;
            font-size: 0.9rem;
        }

        th {
            background: linear-gradient(45deg, #FFD700, #ffffff);
            color: #000000;
            text-transform: uppercase;
            font-family: 'Rajdhani', sans-serif;
            font-weight: 700;
        }

        td {
            color: #ffffff;
        }

        tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.05);
        }

        tr:hover {
            background: rgba(255, 215, 0, 0.15);
        }

        tr.row-78 {
            font-weight: bold;
            color: #FFD700;
        }

        tr.row-88-to-103 {
            background: rgba(255, 215, 0, 0.1);
        }

        tr.category-1 { background: rgba(255, 215, 0, 0.05); }
        tr.category-2 { background: rgba(255, 255, 255, 0.05); }
        tr.category-3 { background: rgba(255, 215, 0, 0.07); }
        tr.category-4 { background: rgba(255, 255, 255, 0.07); }
        tr.category-5 { background: rgba(128, 128, 128, 0.05); }

        tr.selected-row {
            background: linear-gradient(45deg, #000080, #4682B4);
            color: #ffffff;
        }

        #screenshotCanvas {
            display: none;
            margin: 15px auto;
            max-width: 100%;
        }

        .screenshot-container {
            background: #ffffff;
            padding: 15px;
            border-radius: 8px;
            text-align: center;
            font-family: 'Exo 2', sans-serif;
            color: #000000;
            width: 100%;
            max-width: 320px;
            box-sizing: border-box;
            margin: 0 auto;
            height: 400px;
        }

        .screenshot-container h3 {
            font-family: 'Rajdhani', sans-serif;
            font-weight: bold;
            font-size: 1.2rem;
            margin: 8px 0;
            color: #FFD700;
        }

        .screenshot-table {
            width: 100%;
            border-collapse: collapse;
            margin: 10px auto;
        }

        .screenshot-table th,
        .screenshot-table td {
            padding: 6px;
            border: 1px solid #FFD700;
            font-size: 0.9rem;
            text-align: left;
        }

        .screenshot-table th {
            background: linear-gradient(45deg, #FFD700, #ffffff);
            color: #000000;
            font-family: 'Rajdhani', sans-serif;
            font-weight: bold;
        }

        .screenshot-table td {
            background: #f9f9f9;
            color: #000000;
        }

        @media (max-width: 480px) {
            body {
                font-size: 14px;
                padding: 5px;
            }

            .container {
                padding: 10px;
                margin: 5px;
            }

            h1, h2 {
                font-size: 1.2rem;
            }

            h2 {
                font-size: 1rem;
            }

            label {
                font-size: 0.9rem;
            }

            input, select, button {
                padding: 10px;
                font-size: 0.9rem;
            }

            th, td {
                padding: 6px;
                font-size: 0.8rem;
            }

            .header-image {
                width: 100%;
                max-width: 250px;
            }

            .screenshot-container {
                max-width: 100%;
                padding: 10px;
            }
        }

        @media (max-width: 360px) {
            h1, h2 {
                font-size: 1rem;
            }

            label, input, select, button {
                font-size: 0.85rem;
            }

            th, td {
                font-size: 0.75rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <img src="https://i.ibb.co/FF0kvtv/JC.jpg" alt="Banner Jorginho Cred" class="header-image" onerror="alert('Erro ao carregar a imagem do banner. Verifique a conexão ou a URL da imagem.');">
        <h2>Tabela de Taxas</h2>

        <label for="valorInicial">Valor Inicial:</label>
        <input type="number" id="valorInicial" min="0" step="0.01" aria-label="Valor inicial do empréstimo" oninput="calcularValores()">

        <label for="parcelas">Parcelas:</label>
        <input type="number" id="parcelas" min="1" max="21" aria-label="Número de parcelas" oninput="calcularValores()">

        <label for="bandeira">Bandeira:</label>
        <select id="bandeira" aria-label="Bandeira do cartão" onchange="calcularValores()">
            <option value="banese">Banese</option>
            <option value="visa-master">Visa/Master</option>
        </select>

        <button onclick="tirarScreenshot()">Gerar Print</button>

        <div class="table-wrapper">
            <table id="tabelaSimulacao">
                <thead>
                    <tr>
                        <th>Parcelas</th>
                        <th>Juros</th>
                        <th>Valor a Receber</th>
                        <th>Valor a Cobrar</th>
                        <th>Parcela Recebida</th>
                        <th>Parcela a Pagar</th>
                    </tr>
                </thead>
                <tbody>
                    <tr class="row-78 category-1">
                        <td>1x</td>
                        <td id="juros1">-</td>
                        <td id="valorDesc1">-</td>
                        <td id="valorFechado1">-</td>
                        <td id="valorParcelaReceber1">-</td>
                        <td id="valorParcelaCobrar1">-</td>
                    </tr>
                    <tr class="row-88-to-103 category-2">
                        <td>2x</td>
                        <td id="juros2">-</td>
                        <td id="valorDesc2">-</td>
                        <td id="valorFechado2">-</td>
                        <td id="valorParcelaReceber2">-</td>
                        <td id="valorParcelaCobrar2">-</td>
                    </tr>
                    <tr class="row-88-to-103 category-2">
                        <td>3x</td>
                        <td id="juros3">-</td>
                        <td id="valorDesc3">-</td>
                        <td id="valorFechado3">-</td>
                        <td id="valorParcelaReceber3">-</td>
                        <td id="valorParcelaCobrar3">-</td>
                    </tr>
                    <tr class="row-88-to-103 category-2">
                        <td>4x</td>
                        <td id="juros4">-</td>
                        <td id="valorDesc4">-</td>
                        <td id="valorFechado4">-</td>
                        <td id="valorParcelaReceber4">-</td>
                        <td id="valorParcelaCobrar4">-</td>
                    </tr>
                    <tr class="category-3">
                        <td>5x</td>
                        <td id="juros5">-</td>
                        <td id="valorDesc5">-</td>
                        <td id="valorFechado5">-</td>
                        <td id="valorParcelaReceber5">-</td>
                        <td id="valorParcelaCobrar5">-</td>
                    </tr>
                    <tr class="category-3">
                        <td>6x</td>
                        <td id="juros6">-</td>
                        <td id="valorDesc6">-</td>
                        <td id="valorFechado6">-</td>
                        <td id="valorParcelaReceber6">-</td>
                        <td id="valorParcelaCobrar6">-</td>
                    </tr>
                    <tr class="category-3">
                        <td>7x</td>
                        <td id="juros7">-</td>
                        <td id="valorDesc7">-</td>
                        <td id="valorFechado7">-</td>
                        <td id="valorParcelaReceber7">-</td>
                        <td id="valorParcelaCobrar7">-</td>
                    </tr>
                    <tr class="category-3">
                        <td>8x</td>
                        <td id="juros8">-</td>
                        <td id="valorDesc8">-</td>
                        <td id="valorFechado8">-</td>
                        <td id="valorParcelaReceber8">-</td>
                        <td id="valorParcelaCobrar8">-</td>
                    </tr>
                    <tr class="category-4">
                        <td>9x</td>
                        <td id="juros9">-</td>
                        <td id="valorDesc9">-</td>
                        <td id="valorFechado9">-</td>
                        <td id="valorParcelaReceber9">-</td>
                        <td id="valorParcelaCobrar9">-</td>
                    </tr>
                    <tr class="category-4">
                        <td>10x</td>
                        <td id="juros10">-</td>
                        <td id="valorDesc10">-</td>
                        <td id="valorFechado10">-</td>
                        <td id="valorParcelaReceber10">-</td>
                        <td id="valorParcelaCobrar10">-</td>
                    </tr>
                    <tr class="category-4">
                        <td>11x</td>
                        <td id="juros11">-</td>
                        <td id="valorDesc11">-</td>
                        <td id="valorFechado11">-</td>
                        <td id="valorParcelaReceber11">-</td>
                        <td id="valorParcelaCobrar11">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>12x</td>
                        <td id="juros12">-</td>
                        <td id="valorDesc12">-</td>
                        <td id="valorFechado12">-</td>
                        <td id="valorParcelaReceber12">-</td>
                        <td id="valorParcelaCobrar12">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>13x</td>
                        <td id="juros13">-</td>
                        <td id="valorDesc13">-</td>
                        <td id="valorFechado13">-</td>
                        <td id="valorParcelaReceber13">-</td>
                        <td id="valorParcelaCobrar13">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>14x</td>
                        <td id="juros14">-</td>
                        <td id="valorDesc14">-</td>
                        <td id="valorFechado14">-</td>
                        <td id="valorParcelaReceber14">-</td>
                        <td id="valorParcelaCobrar14">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>15x</td>
                        <td id="juros15">-</td>
                        <td id="valorDesc15">-</td>
                        <td id="valorFechado15">-</td>
                        <td id="valorParcelaReceber15">-</td>
                        <td id="valorParcelaCobrar15">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>16x</td>
                        <td id="juros16">-</td>
                        <td id="valorDesc16">-</td>
                        <td id="valorFechado16">-</td>
                        <td id="valorParcelaReceber16">-</td>
                        <td id="valorParcelaCobrar16">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>17x</td>
                        <td id="juros17">-</td>
                        <td id="valorDesc17">-</td>
                        <td id="valorFechado17">-</td>
                        <td id="valorParcelaReceber17">-</td>
                        <td id="valorParcelaCobrar17">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>18x</td>
                        <td id="juros18">-</td>
                        <td id="valorDesc18">-</td>
                        <td id="valorFechado18">-</td>
                        <td id="valorParcelaReceber18">-</td>
                        <td id="valorParcelaCobrar18">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>19x</td>
                        <td id="juros19">-</td>
                        <td id="valorDesc19">-</td>
                        <td id="valorFechado19">-</td>
                        <td id="valorParcelaReceber19">-</td>
                        <td id="valorParcelaCobrar19">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>20x</td>
                        <td id="juros20">-</td>
                        <td id="valorDesc20">-</td>
                        <td id="valorFechado20">-</td>
                        <td id="valorParcelaReceber20">-</td>
                        <td id="valorParcelaCobrar20">-</td>
                    </tr>
                    <tr class="category-5">
                        <td>21x</td>
                        <td id="juros21">-</td>
                        <td id="valorDesc21">-</td>
                        <td id="valorFechado21">-</td>
                        <td id="valorParcelaReceber21">-</td>
                        <td id="valorParcelaCobrar21">-</td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <canvas id="screenshotCanvas" width="320" height="350"></canvas>

    <script>
        function calcularValores() {
            const valorInicial = parseFloat(document.getElementById("valorInicial").value) || 0;
            const parcelas = parseInt(document.getElementById("parcelas").value) || 0;
            const bandeira = document.getElementById("bandeira").value;

            if (valorInicial <= 0 || parcelas < 1 || parcelas > 21) {
                for (let i = 1; i <= 21; i++) {
                    document.getElementById("juros" + i).textContent = "-";
                    document.getElementById("valorDesc" + i).textContent = "-";
                    document.getElementById("valorFechado" + i).textContent = "-";
                    document.getElementById("valorParcelaReceber" + i).textContent = "-";
                    document.getElementById("valorParcelaCobrar" + i).textContent = "-";
                    document.querySelectorAll("tbody tr")[i - 1].classList.remove("selected-row");
                }
                return;
            }

            for (let i = 1; i <= 21; i++) {
                const juros = obterTaxaJuros(i, bandeira);
                const valorReceber = calcularValorDesc(valorInicial, juros);
                const valorCobrar = calcularValorFechado(valorInicial, juros);
                const valorParcelaReceber = valorInicial / i;
                const valorParcelaCobrar = valorCobrar / i;

                document.getElementById("juros" + i).textContent = (juros * 100).toFixed(2) + "%";
                document.getElementById("valorDesc" + i).textContent = valorReceber.toFixed(2);
                document.getElementById("valorFechado" + i).textContent = valorCobrar.toFixed(2);
                document.getElementById("valorParcelaReceber" + i).textContent = valorParcelaReceber.toFixed(2);
                document.getElementById("valorParcelaCobrar" + i).textContent = valorParcelaCobrar.toFixed(2);

                const row = document.querySelectorAll("tbody tr")[i - 1];
                if (i === parcelas) {
                    row.classList.add("selected-row");
                } else {
                    row.classList.remove("selected-row");
                }
            }
        }

        function obterTaxaJuros(parcela, bandeira) {
            const taxasBanese = {
                1: 0.063,
                2: 0.073,
                3: 0.083,
                4: 0.088,
                5: 0.093,
                6: 0.096,
                7: 0.107,
                8: 0.11,
                9: 0.12,
                10: 0.1295,
                11: 0.14,
                12: 0.147,
                13: 0.173,
                14: 0.183,
                15: 0.187,
                16: 0.193,
                17: 0.203,
                18: 0.207,
                19: 0.223,
                20: 0.228,
                21: 0.2395
            };

            const taxasVisaMaster = {
                1: 0.063,
                2: 0.073,
                3: 0.083,
                4: 0.088,
                5: 0.093,
                6: 0.096,
                7: 0.107,
                8: 0.11,
                9: 0.12,
                10: 0.1095,
                11: 0.12,
                12: 0.127,
                13: 0.153,
                14: 0.163,
                15: 0.167,
                16: 0.173,
                17: 0.183,
                18: 0.187,
                19: 0.203,
                20: 0.208,
                21: 0.2195
            };

            if (bandeira === "visa-master") {
                return taxasVisaMaster[parcela] || 0.2195;
            } else {
                return taxasBanese[parcela] || 0.2395;
            }
        }

        function calcularValorFechado(valor, juros) {
            return valor * (1 + juros);
        }

        function calcularValorDesc(valor, juros) {
            return valor / (1 + juros);
        }

        function tirarScreenshot() {
            const valorInicial = parseFloat(document.getElementById("valorInicial").value) || 0;
            const parcelas = parseInt(document.getElementById("parcelas").value) || 0;
            const bandeira = document.getElementById("bandeira").value;

            if (valorInicial <= 0 || parcelas < 1 || parcelas > 21) {
                alert("Por favor, insira um valor inicial válido e número de parcelas entre 1 e 21.");
                return;
            }

            const juros = obterTaxaJuros(parcelas, bandeira);
            const valorRecebido = calcularValorDesc(valorInicial, juros);
            const parcelaRecebida = valorInicial / parcelas;
            const valorPassado = calcularValorFechado(valorInicial, juros);
            const parcelaPassada = valorPassado / parcelas;

            const screenshotContainer = document.createElement("div");
            screenshotContainer.className = "screenshot-container";
            screenshotContainer.innerHTML = `
                <h3>Simulação de Empréstimo</h3>
                <table class="screenshot-table">
                    <thead>
                        <tr>
                            <th>Descrição</th>
                            <th>Valor</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td colspan="2" style="background: #FFD700; color: #000000; font-weight: bold;">Se você passa R$${valorInicial.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Você recebe</td>
                            <td>R$${valorRecebido.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Parcela a Pagar</td>
                            <td>${parcelas}x R$${parcelaRecebida.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td colspan="2" style="background: #FFD700; color: #000000; font-weight: bold;">Se você quer receber R$${valorInicial.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Você passa</td>
                            <td>R$${valorPassado.toFixed(2)}</td>
                        </tr>
                        <tr>
                            <td>Parcela a Pagar</td>
                            <td>${parcelas}x R$${parcelaPassada.toFixed(2)}</td>
                        </tr>
                    </tbody>
                </table>
            `;

            document.body.appendChild(screenshotContainer);

            const canvas = document.getElementById("screenshotCanvas");
            canvas.width = 320;
            canvas.height = 350;
            const ctx = canvas.getContext("2d");

            ctx.clearRect(0, 0, canvas.width, canvas.height);

            html2canvas(screenshotContainer, {
                useCORS: true,
                allowTaint: false,
                backgroundColor: "#ffffff",
                scale: 1
            }).then(canvasImg => {
                ctx.drawImage(canvasImg, 0, 0, canvas.width, canvas.height);
                const link = document.createElement("a");
                link.download = `simulação_${new Date().toISOString().slice(0, 10)}.png`;
                link.href = canvas.toDataURL("image/png");
                link.click();
                document.body.removeChild(screenshotContainer);
                canvas.style.display = "block";
                setTimeout(() => {
                    canvas.style.display = "none";
                }, 2000);
            }).catch(err => {
                console.error("Erro ao gerar screenshot:", err);
                alert("Erro ao gerar o print, possivelmente devido a restrições de CORS na imagem. Tente novamente.");
                document.body.removeChild(screenshotContainer);
            });
        }

        calcularValores();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
</body>
</html>
